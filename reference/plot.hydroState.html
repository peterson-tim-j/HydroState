<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot states or pseudo residuals over time — plot.hydroState • hydroState</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot states or pseudo residuals over time — plot.hydroState"><meta name="description" content="plot produces several figures to visualize pseudo residuals or results of the markov states over time. setInitialYear is required before plot. It is recommend to evaluate the pseudo residuals before the markov states. The pseudo residuals are the probability of an observation occurring at each time-step given the prior observations and latter observations, and these are derived from the conditional probabilities of the observations. The markov states are from the Viterbi algorithm globally decoding the model to estimate the most probable sequence of states."><meta property="og:description" content="plot produces several figures to visualize pseudo residuals or results of the markov states over time. setInitialYear is required before plot. It is recommend to evaluate the pseudo residuals before the markov states. The pseudo residuals are the probability of an observation occurring at each time-step given the prior observations and latter observations, and these are derived from the conditional probabilities of the observations. The markov states are from the Viterbi algorithm globally decoding the model to estimate the most probable sequence of states."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">hydroState</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/hydroState.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/adjust.state.model.html">Adjust the default state model</a></li>
    <li><a class="dropdown-item" href="../articles/subAnnual.models.html">Seasonal and monthly models</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/peterson-tim-j/HydroState/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot states or pseudo residuals over time</h1>
      <small class="dont-index">Source: <a href="https://github.com/peterson-tim-j/HydroState/blob/master/R/wrapper.R" class="external-link"><code>R/wrapper.R</code></a></small>
      <div class="d-none name"><code>plot.hydroState.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>plot</code> produces several figures to visualize pseudo residuals or results of the markov states over time. <code>setInitialYear</code> is required before <code>plot</code>. It is recommend to evaluate the pseudo residuals before the markov states. The pseudo residuals are the probability of an observation occurring at each time-step given the prior observations and latter observations, and these are derived from the conditional probabilities of the observations. The markov states are from the Viterbi algorithm globally decoding the model to estimate the most probable sequence of states.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'hydroState'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  pse.residuals <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ind.variable <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dep.variable <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dep.variable.transformed <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  cond.state.prob <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  siteID <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  do.pdf <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>is the fitted hydroState model object.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments passed for plotting, none available at this time.</p></dd>


<dt id="arg-pse-residuals">pse.residuals<a class="anchor" aria-label="anchor" href="#arg-pse-residuals"></a></dt>
<dd><p>option to plot pseudo residuals. Default is FALSE.</p></dd>


<dt id="arg-ind-variable">ind.variable<a class="anchor" aria-label="anchor" href="#arg-ind-variable"></a></dt>
<dd><p>option to plot independent variable over time. Default is TRUE.</p></dd>


<dt id="arg-dep-variable">dep.variable<a class="anchor" aria-label="anchor" href="#arg-dep-variable"></a></dt>
<dd><p>option to plot dependent variable and states over time. Default is TRUE.</p></dd>


<dt id="arg-dep-variable-transformed">dep.variable.transformed<a class="anchor" aria-label="anchor" href="#arg-dep-variable-transformed"></a></dt>
<dd><p>option to plot transformed dependent variable and states over time. Default is TRUE.</p></dd>


<dt id="arg-cond-state-prob">cond.state.prob<a class="anchor" aria-label="anchor" href="#arg-cond-state-prob"></a></dt>
<dd><p>option to plot the conditional state probabilities over time for each state. Default is TRUE.</p></dd>


<dt id="arg-siteid">siteID<a class="anchor" aria-label="anchor" href="#arg-siteid"></a></dt>
<dd><p>character string of catchment identifier (i.e. gauge ID). Default is NULL. Only recommended when do.pdf = TRUE.</p></dd>


<dt id="arg-do-pdf">do.pdf<a class="anchor" aria-label="anchor" href="#arg-do-pdf"></a></dt>
<dd><p>option to export figures as a pdf. Default is FALSE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>plots to evaluate rainfall-runoff states over time along with observations and the conditional probabilities of each state.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>plot</code></p>
<p><code>plot</code> produces five figures of psuedo residuals OR up to four figures of the results from the fitted hydroState model. When the <code>pse.residuals</code> is FALSE, the default <code>plot</code> produces all four result figures. Figures are more easily viewed as a pdf exported to the current working directory (<code>do.pdf = TRUE</code>).</p><ul><li><p>psuedo residual figures</p><ul><li><p>A) Time-series of normal-pseudo residuals to ensure the residuals each year are within the confidence intervals.</p></li>
<li><p>B) Auto-correlation function (ACF) of normal-pseudo residuals to ensure there is minimal serial correlation in residuals. Lag spikes should be below confidence interval at each lag (except 0).</p></li>
<li><p>C) Histogram of uniform-pseudo residuals should show uniform distribution (equal frequency for each residual value)</p></li>
<li><p>D) Histogram of normal-pseudo residuals should show normal distribution centered on zero and with no skew</p></li>
<li><p>E) Quantile-Quantile (Q-Q) plot where normal-pseudo residuals vs. theoretical quantities should align on the diagonal line. The last plot contains the Akaike information criterion (AIC) and Shapiro-Wilk p-value. The AIC is an estimator to determine the most parsimonious, best performing model given the number of parameters. When comparing models, the lowest AIC is the best performing model. Shapiro-Wilks test for normality in the residuals and a p-value greater than 0.05 (chosen alpha level) indicates the residuals are normally distributed; the null hypothesis that the residuals are normally distributed is not rejected.</p></li>
</ul></li>
<li><p>markov state figures</p><ul><li><p>A) independent variable: precipitation</p></li>
<li><p>B) dependent variable and states: streamflow observations, most likely state, and relative normal state estimate</p></li>
<li><p>C) transformed dependent variable and states: transformed streamflow observations and most likely state</p></li>
<li><p>D) conditional state probabilities for each state: probability of hydroState model remaining in given state</p></li>
</ul></li>
</ul><p>These figures are often large, and below are a few common errors when the plotting window is too small. Exporting the plots as a pdf is recommend for the pseudo residual figure (<code>do.pdf = TRUE</code>).</p><ul><li><p>"Error in plot.new() : figure margins too large": reset plot window with "dev.off()", enlarge plot area and re-run <code>plot.residuals</code>.</p></li>
<li><p>"Error in par(op) : invalid value specified for graphical parameter "pin" if the R plot window is not reset with "dev.off", an additional <code>plot.residuals</code> attempt will result in this error.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Load fitted model</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">model.annual.fitted.221201</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Set initial year to set state names</span></span></span>
<span class="r-in"><span><span class="va">model.annual.fitted.221201</span> <span class="op">=</span></span></span>
<span class="r-in"><span>                  <span class="fu"><a href="setInitialYear.html">setInitialYear</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">model.annual.fitted.221201</span>,</span></span>
<span class="r-in"><span>                  initial.year <span class="op">=</span> <span class="fl">1990</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot only residuals</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model.annual.fitted.221201</span>, pse.residuals <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.hydroState-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot all markov state figures</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model.annual.fitted.221201</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.hydroState-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot only dependent variable transformed with markov states</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model.annual.fitted.221201</span>,</span></span>
<span class="r-in"><span>             ind.variable <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>             dep.variable <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>             dep.variable.transformed <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>             cond.state.prob <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.hydroState-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tim Peterson, Thomas Westfall.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

